==== Протокол обмена данными ====

Предназначен как для web-приложений, так и для отдельных клиентов. Запросы к серверу \---\ обычные POST-запросы, ответы сервера \---\ JSON.

Задачи:
  * получение информации о сервере (версия протокола, текущий пользователь (идентификатор, имя), данные для авторизации (для отдельных клиентов));
  * авторизация;
  * получение таблицы рейтингов;
  * получение информации об игроках (идентификатор, имя, рейтинг, змеи);
  * получение информации о змеях (идентификатор, имя, тип, окраска, программа);
  * \"\заказ\""\ боя (тип, участники);
  * получение информации о проведенных боях (тип, змеи-участники, запись боя);
  * сохранение и получение записей боев;
  * создание, редактирование, удаление змей;
  * выбор бойца для рейтинговых боев.

Все запросы к серверу (за исключением получения информации о сервере) должны содержать идентификатор сессии. Идентификатор (псевдослучайная строка) выдается отдельным клиентам при успешной авторизации. Для web-приложений идентификатор сессии внедряется в код самого приложения. Это служит защитой от XSRF. (Предполагается, что плагины браузера, способные отправлять кроссдоменные HTTP-запросы, не имеют доступа к \"\чужим\""\ cookie).

=== Авторизация ===

Авторизация используется только для отдельных клиентов. Считать, что на сервере хранятся логин и хэш SHA1(логин + ":" + пароль). Ни пароль, ни хеш от пароля не должны пересылаться по сети. Крайне желательно, чтобы каждый запрос авторизации был уникальным. Как вариант: использовать в генерации хэша метку времени, которая не должна сильно отличаться от текущей метки времени сервера. В случае успешной авторизации клиенту выдается идентификатор сессии.

=== Получение таблицы рейтингов ===

Сортировка таблицы по рейтингу, по имени игрока, по возрастанию или убыванию. Выдача среза таблицы.

=== \"\Заказ\""\ боя ===

Для тренировочного боя игрок указывает от 1 до 4 любых змей, допускается участие нескольких экземпляров одной и той же змеи. Для рейтингового боя указывается ровно три различных игрока, участвующих в рейтинге, чьи бойцы будут участвовать в бою; четвертым участником будет боец \"\заказчика\""\. Номера исходных позиций змей соответствуют порядку их перечисления при \"\заказе\""\. В рейтинговом бою боец \"\заказчика\""\ всегда занимает первую позицию.

=== Получение информации о проведенных боях ===

Сервер хранит записи последних N боев, \"\заказанных\""\ игроком и M последних рейтинговых боев, в которых участвовали змеи игрока, \"\заказанные\""\ другими игроками. Количество записей настраивается на сервере.

=== Сохранение и получение записей боев ===

Сервер для каждого игрока хранит фиксированное количество \"\ячеек\""\ для сохраненных записей боев. Изначально все \"\ячейки\""\ пусты. Игрок может заменить содержимое \"\ячейки\""\ записью боя. На момент сохранения запись боя на сервере может уже отсутствовать (из-за вытеснения записями новых боев), поэтому при сохранении серверу передается не идентификатор, а сама запись (тип боя, итог, участники (вместе с программами), запись ходов, отладочная информация).

=== Создание, редактирование, удаление змей ===
